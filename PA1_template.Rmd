---
title: "Activity Monitoring Report"
author: "Hamidreza Rasekhi"
date: "`r Sys.Date()`"
output: html_document
---

## Setup

```{r setup, echo=TRUE, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)

```

## Reading In The Dataset

```{r read-data, echo=TRUE}
data <- read.csv("activity.csv")
str(data)
head(data)

```

## Total Number of Steps Taken Each Day

```{r total-steps, echo=TRUE}
steps_per_day <- data %>%
group_by(date) %>%
summarise(total_steps = sum(steps, na.rm = TRUE))

```

## Histogram of The Total Number of Steps Taken Each Day

```{r Histogram, echo=TRUE}
ggplot(steps_per_day, aes(x = total_steps)) +
geom_histogram(binwidth = 1000, fill = "steelblue", color = "black") +
labs(
title = "Histogram of Total Steps per Day",
x = "Total Steps",
y = "Frequency"
)

```

## Mean And Median Number of Steps Taken Each Day

```{r Mean-Median, echo=TRUE}
mean_steps <- mean(steps_per_day$total_steps)
median_steps <- median(steps_per_day$total_steps)

mean_steps
median_steps

```

## Time Series Plot of The Average Number of Steps Taken

```{r interval-average, echo=TRUE}
interval_avg <- data %>%
group_by(interval) %>%
summarise(avg_steps = mean(steps, na.rm = TRUE))

ggplot(interval_avg, aes(x = interval, y = avg_steps)) +
geom_line(color = "red") +
labs(
title = "Average Number of Steps per 5-Minute Interval",
x = "Interval",
y = "Average Steps"
)

```

## Interval With Maximum Average Number of Steps

```{r time-series, echo=TRUE}
interval_avg %>%
filter(avg_steps == max(avg_steps))

```

## Imputing Missing Values

```{r Imputing Missing Values, echo=TRUE}
sum(is.na(data$steps))

data_imputed <- data

interval_mean <- data %>%
group_by(interval) %>%
summarise(mean_steps = mean(steps, na.rm = TRUE))

data_imputed <- data_imputed %>%
left_join(interval_mean, by = "interval") %>%
mutate(steps = ifelse(is.na(steps), mean_steps, steps)) %>%
select(-mean_steps)

```

## Histogram After Missing Values Are Imputed

```{r Histogram After Imputing, echo=TRUE}
steps_per_day_imputed <- data_imputed %>%
group_by(date) %>%
summarise(total_steps = sum(steps))

ggplot(steps_per_day_imputed, aes(x = total_steps)) +
geom_histogram(binwidth = 1000, fill = "darkgreen", color = "black") +
labs(
title = "Histogram of Total Steps per Day (After Imputation)",
x = "Total Steps",
y = "Frequency"
)

```

## Mean And Median After Imputation

```{r Mean and Median imputed, echo=TRUE}
mean_imputed <- mean(steps_per_day_imputed$total_steps)
median_imputed <- median(steps_per_day_imputed$total_steps)

mean_imputed
median_imputed

```

## Panel Plot Comparing Weekdays Vs Weekends

```{r data_imputed, echo=TRUE}
data_imputed$date <- as.Date(data_imputed$date)

data_imputed$day_type <- ifelse(
weekdays(data_imputed$date) %in% c("Saturday", "Sunday"),
"Weekend",
"Weekday"
)

interval_daytype <- data_imputed %>%
group_by(interval, day_type) %>%
summarise(avg_steps = mean(steps), .groups = "drop")

ggplot(interval_daytype, aes(x = interval, y = avg_steps)) +
geom_line(color = "blue") +
facet_wrap(~day_type, ncol = 1) +
labs(
title = "Average Steps per Interval: Weekdays vs Weekends",
x = "Interval",
y = "Average Steps"
)
